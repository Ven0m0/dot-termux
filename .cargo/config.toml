[unstable]
unstable-options = true
git = true                    # Use git CLI for git operations
gitoxide = true               # Use gitoxide for faster git operations
no-embed-metadata = true      # Reduce binary size by not embedding metadata
avoid-dev-deps = true         # Skip dev dependencies when possible
trim-paths = true             # Strip source paths from binaries for smaller size

[build]
rustc-wrapper = "sccache"     # Use sccache for incremental compilation caching
incremental = false           # Disable incremental compilation (better for CI/release)
jobs = 4                      # Limit parallel jobs to prevent OOM on low-memory devices

# Environment variables for Rust compilation
[env]
CARGO_CACHE_RUSTC_INFO = "1"  # Cache rustc version info
RUSTC_BOOTSTRAP = "1"         # Enable nightly features on stable (use with caution)
CMAKE_BUILD_TYPE = "Release"  # Use release mode for C/C++ dependencies
RUSTC_LOG = "off"             # Disable rustc logging for cleaner output

[http]
debug = false
ssl-version = "tlsv1.2"
check-revoke = false
multiplexing = true

[net]
git-fetch-with-cli = true
retry = 3

[registries.crates-io]
protocol = "sparse"

[resolver]
incompatible-rust-versions = "allow"

[profile.release]
opt-level = 3
codegen-units = 8
lto = "fat"
panic = "abort"
strip = "symbols"
debug = false
debug-assertions = false
overflow-checks = false

[profile.release.build-override]
opt-level = 0
lto = false
codegen-units = 256
incremental = true
debug = false

[profile.dev]
opt-level = 0
lto = false
codegen-units = 256
incremental = true
debug = false

[target.aarch64-linux-android]
rustflags = ["-C", "target-cpu=native"]

[term]
color = 'auto'
progress.when = 'auto'
